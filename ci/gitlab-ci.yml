image: node:lts

before_script:
  - yarn install --immutable

test-compile:
  stage: deploy
  needs: []
  script:
    - yarn tsc --noEmit
    - yarn build
    - yarn lint

pages:
  stage: deploy
  needs: []
  script:
    - yarn build
  artifacts:
    paths:
      - public
  only:
    - master

sync:
  stage: .pre
  script:
    - git remote add github https://github.com/alok0/wallclock1.git
    - git remote add gitlab https://gitlab-ci-token:${REPO_TOKEN}@gitlab.com/aloknull/wallclock.git
    - git fetch github
    - git reset --hard github/master
    - git push gitlab HEAD:master
